<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Eclipse workspace fails to start after crash - quick fix</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Ahti Kitsik / ahtik</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Eclipse workspace fails to start after crash - quick fix</h2>
<p class="meta">15 Jan 2008</p>

<div class="post">
<b>Here's a quick HOWTO for resolving Eclipse startup workspace loading problems. If you have a better suggestion then please leave a comment!</b>

There can be a lot of other issues but here is one of the quite common ones - eclipse resources cache or state gets out of sync/corrupted.

This can happen when your IDE crashes OR also without crashing. For non-crashing case it's more likely a logic/bug problem and whenever possible, try to file a bug at <a href="http://bugs.eclipse.org">bugs.eclipse.org</a>!

Sometimes, just SOMETIMES, you'll get exceptions like following when launching Eclipse IDE after crashing it:

<blockquote>
Root exception:
org.eclipse.core.internal.resources.ResourceException(null)[567]:
  java.io.UTFDataFormatException: malformed input around byte 394
  at java.io.DataInputStream.readUTF(Unknown Source)
  at java.io.DataInputStream.readUTF(Unknown Source)
  at org.eclipse.core.internal.resources.WorkspaceTreeReader_1.
  	readPluginsSavedStates(WorkspaceTreeReader_1.java:111)
  at org.eclipse.core.internal.resources.WorkspaceTreeReader_1.
  	readTree(WorkspaceTreeReader_1.java:159)
  at org.eclipse.core.internal.resources.SaveManager.restoreTree(SaveManager.java:916)
  at org.eclipse.core.internal.resources.SaveManager.restore(SaveManager.java:647)
  at org.eclipse.core.internal.resources.SaveManager.startup(SaveManager.java:1319)
  at org.eclipse.core.internal.resources.Workspace.startup(Workspace.java:1949)
  at org.eclipse.core.internal.resources.Workspace.open(Workspace.java:1713)
  at org.eclipse.core.resources.ResourcesPlugin.start(ResourcesPlugin.java:363)
  at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.
  	run(BundleContextImpl.java:999)
  at java.security.AccessController.doPrivileged(Native Method)
</blockquote>

The key here is row "org.eclipse.core.internal.resources.SaveManager.restore(SaveManager.java:647)".

This stakctrace means your root .tree file is damaged and thereby unable to restore your opened projects.

The quickest way to fix this or any other resource-related exception is to:
<ol>
<li>Shut down Eclipse IDE
<li>Remove and backup your workspace/.metadata/.plugins/org.eclipse.core.resources directory
<li>Start Eclipse IDE (with -clean to be super-safe)
<li>Reimport all projects (<b>UPDATE:</b> Just use File-&gt;Import-&gt;Existing Project into Workspace and browse your workspace/project directory)
<li>Enjoy
</ol>

Maybe deleting workspace/.metadata/.plugins/org.eclipse.core.resources/.root/*tree would have been good enough for my case but it's definitely not a workaround for other possible workspace resource state and cache related exceptions.

I'm not sure if this information without any reproducible steps is useful for bugs.eclipse.org. Not filing it this time. Or should I?

<p><b>UPDATE:</b> If this does not work then Shaneem from comments got it fixed this way:
<blockquote>
All these didn't work for me. I finally checked ./metadata/.log file and found a message like "I don't like this report action you copied from another proxy service". So opened the proxy service in text editor and removed it. Bingo! All errors vanished!
</blockquote>
</p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Ahti Kitsik<br />
                Java, Eclipse RCP, Python, Node.js, web apps developer<br />
                ak@ahtik.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/ahtik">github.com/ahtik</a><br />
                <a href="https://twitter.com/ahtik">twitter.com/ahtik</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
